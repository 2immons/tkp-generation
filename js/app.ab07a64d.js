(function(){"use strict";var e={988:function(e,t,l){var a=l(5130),n=l(6768);function u(e,t){const l=(0,n.g2)("router-view");return(0,n.uX)(),(0,n.Wv)(l)}var o=l(1241);const r={},s=(0,o.A)(r,[["render",u]]);var i=s,c=l(1387),p=(l(4114),l(4232)),d=l(144),v=l(1446),h=l.n(v),k=l(6020),b=l.n(k),L=l(788),m=l(1421);const f=e=>((0,n.Qi)("data-v-cb8ec836"),e=e(),(0,n.jt)(),e),w={class:"container"},y={class:"file-upload-container"},_={class:"file-upload-wrapper"},g=f((()=>(0,n.Lk)("label",{class:"file-label",for:"actual-btn"},"Загрузить шаблон",-1))),W={id:"file-chosen"},N={key:0,class:"file-error-wrapper"},x=f((()=>(0,n.Lk)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,n.Lk)("path",{d:"M12 12V7.5M12 15.3354V15.375M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"red","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1))),O={class:"header-inputs"},V={class:"input-group input-group__number-date"},C={class:"input-wrapper"},U=f((()=>(0,n.Lk)("label",null,"№ КП:",-1))),I={class:"input-wrapper"},K=f((()=>(0,n.Lk)("label",null,"Дата КП:",-1))),J={class:"input-group input-group__org"},E={class:"input-wrapper"},R=f((()=>(0,n.Lk)("label",null,"Заказчик:",-1))),M={class:"input-wrapper"},A=f((()=>(0,n.Lk)("label",null,"Отдел:",-1))),D={class:"characteristics-toggler-wrapper"},S={class:"checkbox-wrapper"},$=f((()=>(0,n.Lk)("span",{class:"checkmark"},null,-1))),j=f((()=>(0,n.Lk)("span",null,"Характеристики",-1))),F={class:"table"},B={class:"table__header"},T=f((()=>(0,n.Lk)("th",{class:"header-cell",style:{width:"4%"}},[(0,n.eW)("№"),(0,n.Lk)("br"),(0,n.eW)("п/п")],-1))),X=f((()=>(0,n.Lk)("th",{class:"header-cell",style:{width:"18%"}},[(0,n.eW)("Наименование"),(0,n.Lk)("br"),(0,n.eW)("(Требование)")],-1))),q={key:0,class:"header-cell",style:{width:"20%"}},H=f((()=>(0,n.Lk)("br",null,null,-1))),Q=f((()=>(0,n.Lk)("th",{class:"header-cell",style:{width:"20%"}},[(0,n.eW)("Предложение участника"),(0,n.Lk)("br"),(0,n.eW)("(выделить аналоги)")],-1))),Z=f((()=>(0,n.Lk)("th",{class:"header-cell",style:{width:"7%"}},[(0,n.eW)("Ед."),(0,n.Lk)("br"),(0,n.eW)("измер.")],-1))),P=f((()=>(0,n.Lk)("th",{class:"header-cell",style:{width:"7%"}},"Кол-во",-1))),G=f((()=>(0,n.Lk)("th",{class:"header-cell",style:{width:"10%"}},[(0,n.eW)("Цена за ед.,"),(0,n.Lk)("br"),(0,n.eW)("без НДС")],-1))),z=f((()=>(0,n.Lk)("th",{class:"header-cell",style:{width:"10%"}},[(0,n.eW)("Стоимость,"),(0,n.Lk)("br"),(0,n.eW)("без НДС")],-1))),Y=f((()=>(0,n.Lk)("th",{class:"header-cell",style:{width:"4%"}},null,-1))),ee={class:"table__body"},te={class:"cell cell--index"},le={class:"cell"},ae=["onUpdate:modelValue"],ne={key:0,class:"cell"},ue=["onUpdate:modelValue"],oe={class:"cell cell--checkbox"},re=["onUpdate:modelValue"],se={class:"checkbox-wrapper tooltip"},ie=f((()=>(0,n.Lk)("span",{class:"tooltip__text"},"Выделить аналог",-1))),ce=["onUpdate:modelValue"],pe=f((()=>(0,n.Lk)("span",{class:"checkmark"},null,-1))),de={class:"cell"},ve=["onUpdate:modelValue"],he={class:"cell"},ke=["onUpdate:modelValue","onInput"],be={class:"cell"},Le=["onUpdate:modelValue","onInput"],me={class:"cell"},fe=["onUpdate:modelValue","onInput"],we={class:"cell cell--button"},ye=["onClick"],_e=f((()=>(0,n.Lk)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[(0,n.Lk)("path",{d:"M4 6.17647H20M9 3H15M10 16.7647V10.4118M14 16.7647V10.4118M15.5 21H8.5C7.39543 21 6.5 20.0519 6.5 18.8824L6.0434 7.27937C6.01973 6.67783 6.47392 6.17647 7.04253 6.17647H16.9575C17.5261 6.17647 17.9803 6.67783 17.9566 7.27937L17.5 18.8824C17.5 20.0519 16.6046 21 15.5 21Z",stroke:"red","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1))),ge=[_e],We={class:"input-group input-group__price"},Ne={class:"input-wrapper"},xe=f((()=>(0,n.Lk)("label",{class:"total-price-label"},"Всего без НДС:",-1))),Oe={class:"input-wrapper"},Ve=f((()=>(0,n.Lk)("label",{class:"total-price-label"},"НДС (20%):",-1))),Ce={class:"input-wrapper"},Ue=f((()=>(0,n.Lk)("label",{class:"total-price-label"},"Всего с НДС:",-1))),Ie={class:"input-group input-group__footer"},Ke={class:"input-wrapper input-wrapper--with-borders"},Je=f((()=>(0,n.Lk)("label",null,"Условия доставки:",-1))),Ee={class:"input-wrapper input-wrapper--with-borders"},Re=f((()=>(0,n.Lk)("label",null,"Срок оплаты:",-1))),Me=f((()=>(0,n.Lk)("span",null,"календарных дней",-1))),Ae={class:"input-wrapper input-wrapper--with-borders"},De=f((()=>(0,n.Lk)("label",null,"Срок предложения:",-1))),Se=f((()=>(0,n.Lk)("span",null,"календарных дней",-1))),$e={class:"footer-buttons"};var je=(0,n.pM)({__name:"InputForm",setup(e){(0,n.sV)((()=>{l(),window.addEventListener("beforeunload",t)})),(0,n.xo)((()=>{window.removeEventListener("beforeunload",t)}));const t=()=>{sessionStorage.setItem("state",JSON.stringify({accountNumber:u.value,accountDate:o.value,organisationName:r.value,organisationDept:s.value,totalWithoutNds:i.value,nds:c.value,totalWithNds:v.value,paymentConditions:k.value,deliveryTime:f.value,paymentTime:_e.value,positions:Fe.value,isCharacteristicsInUse:je.value,fileName:qe.value,fileData:Be.value,isError:Te.value,errorMsg:Xe.value}))},l=()=>{const e=sessionStorage.getItem("state");if(e){const t=JSON.parse(e);u.value=t.accountNumber,o.value=t.accountDate,r.value=t.organisationName,s.value=t.organisationDept,i.value=t.totalWithoutNds,c.value=t.nds,v.value=t.totalWithNds,k.value=t.paymentConditions,f.value=t.deliveryTime,_e.value=t.paymentTime,Fe.value=t.positions,je.value=t.isCharacteristicsInUse,qe.value=t.fileName,Be.value=t.fileData,Te.value=t.isError,Xe.value=t.errorMsg}},u=(0,d.KR)(""),o=(0,d.KR)(""),r=(0,d.KR)(""),s=(0,d.KR)("В тендерный отдел"),i=(0,d.KR)(0),c=(0,d.KR)(0),v=(0,d.KR)(0),k=(0,d.KR)("в соответствии с проектом договора"),f=(0,d.KR)(90),_e=(0,d.KR)(30),je=(0,d.KR)(!0),Fe=(0,d.KR)([{index:1,name:"",characteristics:"",productOffer:"",productOfferIsAnalog:!1,unit:"шт",quantity:1,priceWithoutNds:0,sumWithOutNds:0,priceWithoutNdsStr:"0.00",sumWithOutNdsStr:"0.00"}]),Be=(0,d.KR)(null),Te=(0,d.KR)(!1),Xe=(0,d.KR)(""),qe=(0,d.KR)("Шаблон не загружен"),He=e=>{const t=e.target,l=t.files?.[0];if(qe.value="Шаблон не загружен",Be.value=null,l){if(Te.value=!1,!l.name.includes(".docx")||!l.name.includes(".doc"))return void Qe("Неправильное расширение файла.Необходимо .docx или .doc");qe.value=l.name;const e=new FileReader;e.onload=()=>{Be.value=e.result},e.readAsArrayBuffer(l)}},Qe=e=>{Xe.value=e,Te.value=!0},Ze=e=>{e.sumWithOutNds=e.priceWithoutNds*e.quantity,Ge()},Pe=e=>{0===e.quantity?e.priceWithoutNds=0:e.priceWithoutNds=e.sumWithOutNds/e.quantity,Ge()},Ge=()=>{i.value=0,Fe.value.forEach((e=>{i.value+=e.sumWithOutNds})),c.value=.2*i.value,v.value=c.value+i.value},ze=e=>{"."!==e.key&&","!==e.key||e.preventDefault()},Ye=e=>{const t=e.target,l=parseFloat(t.value);isNaN(l)||(t.value=l.toFixed(2))},et=e=>isNaN(e)?"0.00":e.toFixed(2),tt=(e,t)=>"именительный падеж"===t?e%10===1?`${e} календарный день`:e%10===2||e%10===3||e%10===4?`${e} календарных дня`:`${e} календарных дней`:"родительный падеж"===t?e%10===1?`${e} календарного дня`:`${e} календарных дней`:void 0,lt=e=>{const t=e.split("-");return`${t[2]}.${t[1]}.${t[0]}`},at=e=>{console.log(e)},nt=async e=>{if(Te.value=!1,!Be.value)return void Qe("Шаблон документа не загружен");if(je.value||(Fe.value=Fe.value.map((e=>{const{characteristics:t,...l}=e;return l}))),""===u.value||""===o.value||""===r.value||""===s.value||""===k.value||!(i.value>0)||!(c.value>0)||!(v.value>0)||!(f.value>0)||!(_e.value>0))return void Qe("Не указаны необходимые переменные!");const t=new(h())(Be.value),l=new(b())(t,{paragraphLoop:!0,linebreaks:!0});Fe.value.forEach((e=>{e.priceWithoutNdsStr=et(e.priceWithoutNds),e.sumWithOutNdsStr=et(e.sumWithOutNds)}));const a={accountNumber:u.value,accountDate:lt(o.value),organisationName:r.value,organisationDept:s.value,totalWithoutNds:et(i.value),ndsSum:et(.2*i.value),totalWithNds:et(v.value),totalWithNdsLetters:(0,m.C)(v.value),deliveryConditions:k.value,paymentTime:tt(_e.value,"именительный падеж"),deliveryTime:tt(f.value,"родительный падеж"),positions:Fe.value,isCharacteristicsInUse:je.value};l.setData(a);try{l.render()}catch(d){throw console.error("Ошибка при рендеринге шаблона",d),d}const n=l.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}),p=`ТКП_№${u.value}_от_${o.value}_для_${r.value}.docx`;at(n),e&&(0,L.saveAs)(n,p)},ut=()=>{const e={index:Fe.value.length+1,name:"",characteristics:"",productOffer:"",productOfferIsAnalog:!1,unit:"шт",quantity:1,priceWithoutNds:0,sumWithOutNds:0,priceWithoutNdsStr:"0.00",sumWithOutNdsStr:"0.00"};Fe.value.push(e)},ot=e=>{const t=Fe.value.indexOf(e);-1!==t&&Fe.value.splice(t,1)};return(e,t)=>((0,n.uX)(),(0,n.CE)("div",w,[(0,n.Lk)("div",y,[(0,n.Lk)("div",_,[(0,n.Lk)("input",{class:"file-input",type:"file",id:"actual-btn",hidden:"",onChange:He},null,32),g,(0,n.Lk)("span",W,(0,p.v_)(qe.value),1)]),Te.value?((0,n.uX)(),(0,n.CE)("span",N,[x,(0,n.Lk)("p",null,(0,p.v_)(Xe.value),1)])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",O,[(0,n.Lk)("div",V,[(0,n.Lk)("div",C,[U,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>u.value=e),type:"text",placeholder:"1234"},null,512),[[a.Jo,u.value]])]),(0,n.Lk)("div",I,[K,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.value=e),type:"date"},null,512),[[a.Jo,o.value]])])]),(0,n.Lk)("div",J,[(0,n.Lk)("div",E,[R,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),type:"text",placeholder:"Наименование организации"},null,512),[[a.Jo,r.value]])]),(0,n.Lk)("div",M,[A,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>s.value=e),type:"text",placeholder:"Например: 'В отдел продаж', 'В тендерный отдел'"},null,512),[[a.Jo,s.value]])])])]),(0,n.Lk)("div",D,[(0,n.Lk)("label",S,[(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=e=>je.value=e)},null,512),[[a.lH,je.value]]),$]),j]),(0,n.Lk)("table",F,[(0,n.Lk)("thead",B,[(0,n.Lk)("tr",null,[T,X,je.value?((0,n.uX)(),(0,n.CE)("th",q,[(0,n.eW)("Требуемые"),H,(0,n.eW)("характеристики")])):(0,n.Q3)("",!0),Q,Z,P,G,z,Y])]),(0,n.Lk)("tbody",ee,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(Fe.value,((e,t)=>((0,n.uX)(),(0,n.CE)("tr",{key:t},[(0,n.Lk)("th",te,(0,p.v_)(e.index),1),(0,n.Lk)("th",le,[(0,n.bo)((0,n.Lk)("textarea",{class:"cell__textarea","onUpdate:modelValue":t=>e.name=t},null,8,ae),[[a.Jo,e.name]])]),je.value?((0,n.uX)(),(0,n.CE)("th",ne,[(0,n.bo)((0,n.Lk)("textarea",{class:"cell__textarea","onUpdate:modelValue":t=>e.characteristics=t},null,8,ue),[[a.Jo,e.characteristics]])])):(0,n.Q3)("",!0),(0,n.Lk)("th",oe,[(0,n.bo)((0,n.Lk)("textarea",{class:"cell__textarea","onUpdate:modelValue":t=>e.productOffer=t},null,8,re),[[a.Jo,e.productOffer]]),(0,n.Lk)("label",se,[ie,(0,n.bo)((0,n.Lk)("input",{type:"checkbox","onUpdate:modelValue":t=>e.productOfferIsAnalog=t},null,8,ce),[[a.lH,e.productOfferIsAnalog]]),pe])]),(0,n.Lk)("th",de,[(0,n.bo)((0,n.Lk)("input",{class:"cell__input cell__input--short",type:"text","onUpdate:modelValue":t=>e.unit=t},null,8,ve),[[a.Jo,e.unit]])]),(0,n.Lk)("th",he,[(0,n.bo)((0,n.Lk)("input",{class:"cell__input cell__input--short",type:"number","onUpdate:modelValue":t=>e.quantity=t,onInput:t=>Ze(e)},null,40,ke),[[a.Jo,e.quantity]])]),(0,n.Lk)("th",be,[(0,n.bo)((0,n.Lk)("input",{class:"cell__input cell__input--price",type:"number","onUpdate:modelValue":t=>e.priceWithoutNds=t,onBlur:Ye,onInput:t=>Ze(e)},null,40,Le),[[a.Jo,e.priceWithoutNds]])]),(0,n.Lk)("th",me,[(0,n.bo)((0,n.Lk)("input",{class:"cell__input cell__input--price",type:"number","onUpdate:modelValue":t=>e.sumWithOutNds=t,onBlur:Ye,onInput:t=>Pe(e)},null,40,fe),[[a.Jo,e.sumWithOutNds]])]),(0,n.Lk)("th",we,[(0,n.Lk)("button",{class:"btn__remove",onClick:t=>ot(e)},ge,8,ye)])])))),128))])]),(0,n.Lk)("button",{class:"btn btn__add-position",onClick:ut},"Добавить позицию"),(0,n.Lk)("div",We,[(0,n.Lk)("div",Ne,[xe,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>i.value=e),onBlur:Ye,type:"number",placeholder:"12345,12"},null,544),[[a.Jo,i.value]])]),(0,n.Lk)("div",Oe,[Ve,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>c.value=e),onBlur:Ye,type:"number",placeholder:"12345,12"},null,544),[[a.Jo,c.value]])]),(0,n.Lk)("div",Ce,[Ue,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>v.value=e),onBlur:Ye,type:"number",placeholder:"12345,12"},null,544),[[a.Jo,v.value]])])]),(0,n.Lk)("div",Ie,[(0,n.Lk)("div",Ke,[Je,(0,n.bo)((0,n.Lk)("textarea",{"onUpdate:modelValue":t[8]||(t[8]=e=>k.value=e)},null,512),[[a.Jo,k.value]])]),(0,n.Lk)("div",Ee,[Re,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>_e.value=e),type:"number",step:"1",onKeydown:ze},null,544),[[a.Jo,_e.value]]),Me]),(0,n.Lk)("div",Ae,[De,(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>f.value=e),type:"number",step:"1",onKeydown:ze},null,544),[[a.Jo,f.value]]),Se])]),(0,n.Lk)("div",$e,[(0,n.Lk)("button",{class:"btn btn__preview",onClick:t[11]||(t[11]=e=>nt(!1))},"Предпросмотр документа"),(0,n.Lk)("button",{class:"btn btn__generate",onClick:t[12]||(t[12]=e=>nt(!0))},"Сгенерировать документ")])]))}});const Fe=(0,o.A)(je,[["__scopeId","data-v-cb8ec836"]]);var Be=Fe,Te=l.p+"img/Logo.b4dbda6f.png";const Xe=e=>((0,n.Qi)("data-v-7d25e236"),e=e(),(0,n.jt)(),e),qe=Xe((()=>(0,n.Lk)("div",{class:"container"},[(0,n.Lk)("img",{src:Te,alt:""}),(0,n.Lk)("h1",null,"DocsGeneration")],-1))),He=[qe];function Qe(e,t){return(0,n.uX)(),(0,n.CE)("header",null,He)}const Ze={},Pe=(0,o.A)(Ze,[["render",Qe],["__scopeId","data-v-7d25e236"]]);var Ge=Pe,ze=(0,n.pM)({__name:"MainView",setup(e){return(e,t)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(Ge),(0,n.Lk)("main",null,[(0,n.bF)(Be)])],64))}});const Ye=(0,o.A)(ze,[["__scopeId","data-v-4941a01e"]]);var et=Ye;const tt=[{path:"/",name:"home",component:et}],lt=(0,c.aE)({history:(0,c.Bt)(),routes:tt});var at=lt;(0,a.Ef)(i).use(at).mount("#app")}},t={};function l(a){var n=t[a];if(void 0!==n)return n.exports;var u=t[a]={exports:{}};return e[a].call(u.exports,u,u.exports,l),u.exports}l.m=e,function(){var e=[];l.O=function(t,a,n,u){if(!a){var o=1/0;for(c=0;c<e.length;c++){a=e[c][0],n=e[c][1],u=e[c][2];for(var r=!0,s=0;s<a.length;s++)(!1&u||o>=u)&&Object.keys(l.O).every((function(e){return l.O[e](a[s])}))?a.splice(s--,1):(r=!1,u<o&&(o=u));if(r){e.splice(c--,1);var i=n();void 0!==i&&(t=i)}}return t}u=u||0;for(var c=e.length;c>0&&e[c-1][2]>u;c--)e[c]=e[c-1];e[c]=[a,n,u]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var a in t)l.o(t,a)&&!l.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.p="/tkp-generation/"}(),function(){var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,a){var n,u,o=a[0],r=a[1],s=a[2],i=0;if(o.some((function(t){return 0!==e[t]}))){for(n in r)l.o(r,n)&&(l.m[n]=r[n]);if(s)var c=s(l)}for(t&&t(a);i<o.length;i++)u=o[i],l.o(e,u)&&e[u]&&e[u][0](),e[u]=0;return l.O(c)},a=self["webpackChunktkp_generation"]=self["webpackChunktkp_generation"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=l.O(void 0,[504],(function(){return l(988)}));a=l.O(a)})();
//# sourceMappingURL=app.ab07a64d.js.map